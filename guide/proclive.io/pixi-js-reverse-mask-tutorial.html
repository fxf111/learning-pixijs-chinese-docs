<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PIXI.js 拖放教程 | Pixi.js中文网</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="Pixi.js中文网">
    <link rel="preload" href="/assets/css/0.styles.362d92e2.css" as="style"><link rel="preload" href="/assets/js/app.a8316c89.js" as="script"><link rel="preload" href="/assets/js/2.e1e3a62a.js" as="script"><link rel="preload" href="/assets/js/15.df4177f0.js" as="script"><link rel="prefetch" href="/assets/js/10.ae3da496.js"><link rel="prefetch" href="/assets/js/11.134f7f48.js"><link rel="prefetch" href="/assets/js/12.24dbe613.js"><link rel="prefetch" href="/assets/js/13.e7abb94d.js"><link rel="prefetch" href="/assets/js/14.3b4025bf.js"><link rel="prefetch" href="/assets/js/16.34b83404.js"><link rel="prefetch" href="/assets/js/17.0c57a63c.js"><link rel="prefetch" href="/assets/js/18.4d1db52c.js"><link rel="prefetch" href="/assets/js/19.4ac2b8e0.js"><link rel="prefetch" href="/assets/js/20.19191963.js"><link rel="prefetch" href="/assets/js/21.b5757746.js"><link rel="prefetch" href="/assets/js/22.a54ada0e.js"><link rel="prefetch" href="/assets/js/23.8660e6c8.js"><link rel="prefetch" href="/assets/js/24.ace42ec4.js"><link rel="prefetch" href="/assets/js/25.0f720ad2.js"><link rel="prefetch" href="/assets/js/26.cd2c99d8.js"><link rel="prefetch" href="/assets/js/27.cda87ac0.js"><link rel="prefetch" href="/assets/js/28.8ecd46b2.js"><link rel="prefetch" href="/assets/js/29.fa362f06.js"><link rel="prefetch" href="/assets/js/3.b27acdb4.js"><link rel="prefetch" href="/assets/js/30.2db59bd0.js"><link rel="prefetch" href="/assets/js/31.efa382b4.js"><link rel="prefetch" href="/assets/js/32.b642dd9b.js"><link rel="prefetch" href="/assets/js/33.b3fae3c6.js"><link rel="prefetch" href="/assets/js/34.be7cf7f7.js"><link rel="prefetch" href="/assets/js/35.fcf8cda2.js"><link rel="prefetch" href="/assets/js/36.51d3d091.js"><link rel="prefetch" href="/assets/js/37.78239966.js"><link rel="prefetch" href="/assets/js/38.ed5defa4.js"><link rel="prefetch" href="/assets/js/39.b702a6c6.js"><link rel="prefetch" href="/assets/js/4.5192ec08.js"><link rel="prefetch" href="/assets/js/40.c82bd0f1.js"><link rel="prefetch" href="/assets/js/41.734cd73b.js"><link rel="prefetch" href="/assets/js/42.f1ca25cd.js"><link rel="prefetch" href="/assets/js/43.76a7b733.js"><link rel="prefetch" href="/assets/js/44.b85b669a.js"><link rel="prefetch" href="/assets/js/45.4a3e150d.js"><link rel="prefetch" href="/assets/js/5.0e6f24a2.js"><link rel="prefetch" href="/assets/js/6.1bdc678b.js"><link rel="prefetch" href="/assets/js/7.df3db682.js"><link rel="prefetch" href="/assets/js/8.9c259b18.js"><link rel="prefetch" href="/assets/js/9.8892d868.js">
    <link rel="stylesheet" href="/assets/css/0.styles.362d92e2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/pixijs-v5-logo-1.png" alt="Pixi.js中文网" class="logo"> <span class="site-name can-hide">Pixi.js中文网</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          学习
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/guide/start/1.introduction.html" class="nav-link">
  入门教程
</a></li><li class="dropdown-subitem"><a href="/guide/parallax-scroller/part-1.html" class="nav-link">
  进阶教程
</a></li></ul></li><li class="dropdown-item"><h4>
          其它
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="http://b.aitrade.ga/pixi.js-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="/pages/folder2/test4.html" class="nav-link">
  琐碎
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/example/container.html" class="nav-link">
  示例
</a></div><div class="nav-item"><a href="https://github.com/fxf111/pixijs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          学习
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/guide/start/1.introduction.html" class="nav-link">
  入门教程
</a></li><li class="dropdown-subitem"><a href="/guide/parallax-scroller/part-1.html" class="nav-link">
  进阶教程
</a></li></ul></li><li class="dropdown-item"><h4>
          其它
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="http://b.aitrade.ga/pixi.js-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="/pages/folder2/test4.html" class="nav-link">
  琐碎
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/example/container.html" class="nav-link">
  示例
</a></div><div class="nav-item"><a href="https://github.com/fxf111/pixijs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>起步</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>进阶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>制作视差滚动</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>proclive.io PIXI教程</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/proclive.io/shooting-tutorial.html" class="sidebar-link">旋转鼠标射击游戏</a></li><li><a href="/guide/proclive.io/pixi-js-drag-drop.html" class="sidebar-link">拖放教程</a></li><li><a href="/guide/proclive.io/pixi-js-reverse-mask-tutorial.html" class="active sidebar-link">反面罩教程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/proclive.io/pixi-js-reverse-mask-tutorial.html#pixi-js-拖放教程" class="sidebar-link">PIXI.js 拖放教程</a></li><li class="sidebar-sub-header"><a href="/guide/proclive.io/pixi-js-reverse-mask-tutorial.html#长话短说，上干货" class="sidebar-link">长话短说，上干货</a></li><li class="sidebar-sub-header"><a href="/guide/proclive.io/pixi-js-reverse-mask-tutorial.html#初始化设置" class="sidebar-link">初始化设置</a></li><li class="sidebar-sub-header"><a href="/guide/proclive.io/pixi-js-reverse-mask-tutorial.html#有趣的部分" class="sidebar-link">有趣的部分</a></li></ul></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="pixi-js-拖放教程"><a href="#pixi-js-拖放教程" class="header-anchor">#</a> PIXI.js 拖放教程</h2> <p>是时候回馈社区了，所以这次的教程是很多人比较感兴趣的。
我想要这样一个创建渐进层，中心比较明亮，边缘暗淡，就像光一样。
这里是一张我们目前正在开发中的应用了该效果之前和之后对比的游戏截图。</p> <p><img src="/images/tutorial/tutorialWithoutDark.png" alt=""></p> <p><img src="/images/tutorial/tutorialWithDark.png" alt=""></p> <h2 id="长话短说，上干货"><a href="#长话短说，上干货" class="header-anchor">#</a> 长话短说，上干货</h2> <p>这是第一课,你很可能在这里复制粘贴,了解它的工作原理然后继续,
所以我要让它尽可能的容易。
版本较长，向下滑动即可。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
* @param size of the screen {width: 800, height: 800}
* @param renderer just pass the renderer
*/</span>
<span class="token keyword">var</span> <span class="token function-variable function">Light</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">size<span class="token punctuation">,</span> renderer</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>size <span class="token operator">=</span> size<span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>renderer <span class="token operator">=</span> renderer<span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> size<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> size<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>ctx <span class="token operator">=</span> self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>renderTexture <span class="token operator">=</span> <span class="token constant">PIXI</span><span class="token punctuation">.</span>RenderTexture<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">,</span> self<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>maskSprite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>renderTexture<span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span><span class="token function">rendMask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>darkTex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Texture<span class="token punctuation">.</span>fromImage</span><span class="token punctuation">(</span><span class="token string">&quot;assets/overlay2.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>darkSprite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>darkTex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>darkSprite<span class="token punctuation">.</span>filters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>SpriteMaskFilter</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>maskSprite<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>darkSprite<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> pt <span class="token operator">=</span> <span class="token class-name">Light</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

pt<span class="token punctuation">.</span><span class="token function-variable function">rendMask</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">center<span class="token punctuation">,</span> smallLights</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>center<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    center <span class="token operator">=</span> <span class="token punctuation">{</span>
      x<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">300</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    center<span class="token punctuation">.</span>x <span class="token operator">=</span> center<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    center<span class="token punctuation">.</span>y <span class="token operator">=</span> center<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  self<span class="token punctuation">.</span>ctx <span class="token operator">=</span> self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> gradient <span class="token operator">=</span> self<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">createRadialGradient</span><span class="token punctuation">(</span>center<span class="token punctuation">.</span>x<span class="token punctuation">,</span> center<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> center<span class="token punctuation">.</span>x<span class="token punctuation">,</span> center<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> gradient<span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>self<span class="token punctuation">.</span>spr<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> texture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Texture<span class="token punctuation">.</span>fromCanvas</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>spr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>texture<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    self<span class="token punctuation">.</span>spr<span class="token punctuation">.</span>texture<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  self<span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>spr<span class="token punctuation">,</span> self<span class="token punctuation">.</span>renderTexture<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//module.exports = Light;</span>
<span class="token keyword">var</span> light <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Light</span><span class="token punctuation">(</span><span class="token punctuation">{</span>width<span class="token operator">:</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">}</span><span class="token punctuation">,</span> renderer<span class="token punctuation">)</span><span class="token punctuation">;</span>

stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p>在代码里这样使用</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>light<span class="token punctuation">.</span><span class="token function">rendMask</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token operator">:</span> renderer<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>interaction<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span>global<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y<span class="token operator">:</span> renderer<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>interaction<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span>global<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="初始化设置"><a href="#初始化设置" class="header-anchor">#</a> 初始化设置</h2> <p>我会尽量让这个尽可能的简单，所以我先使用基本pixi.js第一部分的基础示例,
文件和目录结构是这样的:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>./
./assets/bunny.png
./assets/overlay2.jpg
./lib/pixi.js
./index.html
./main.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这里是index.html</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE HTML&gt;</span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>  
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Proclive Tutorials: Light<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">body</span> <span class="token punctuation">{</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
            <span class="token property">background-color</span><span class="token punctuation">:</span> #000000<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>lib/pixi.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>main.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>main.js</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> renderer <span class="token operator">=</span> <span class="token constant">PIXI</span><span class="token punctuation">.</span><span class="token function">autoDetectRenderer</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span><span class="token punctuation">{</span>backgroundColor <span class="token operator">:</span> <span class="token number">0x1099bb</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>renderer<span class="token punctuation">.</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// create the root of the scene graph</span>
<span class="token keyword">var</span> stage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// create a texture from an image path</span>
<span class="token keyword">var</span> texture <span class="token operator">=</span> <span class="token constant">PIXI</span><span class="token punctuation">.</span>Texture<span class="token punctuation">.</span><span class="token function">fromImage</span><span class="token punctuation">(</span><span class="token string">'assets/bunny.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// create a new Sprite using the texture</span>
<span class="token keyword">var</span> bunny <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>texture<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// center the sprite's anchor point</span>
bunny<span class="token punctuation">.</span>anchor<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>  
bunny<span class="token punctuation">.</span>anchor<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>

<span class="token comment">// move the sprite to the center of the screen</span>
bunny<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>  
bunny<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span>

stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>bunny<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// start animating</span>
<span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// just for fun, let's rotate mr rabbit a little</span>
    bunny<span class="token punctuation">.</span>rotation <span class="token operator">+=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>

    <span class="token comment">// render the container</span>
    renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>stage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="有趣的部分"><a href="#有趣的部分" class="header-anchor">#</a> 有趣的部分</h2> <p>好了,是时候把兔子放到黑暗中啦。
在我的游戏中，我用这张图片添加划痕到屏幕上,
如果你想清晰的过渡的话，就不需要使用它。看你的需要啦，
这是我用的图片(是jpg格式的,没有透明度)</p> <p><img src="/images/tutorial/overlay2.jpg" alt=""></p> <p>这段代码可以使它生效</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/**
* @param size of the screen {width: 800, height: 800}
* @param renderer just pass the renderer
*/</span>
<span class="token keyword">var</span> <span class="token function-variable function">Light</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">size<span class="token punctuation">,</span> renderer</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>size <span class="token operator">=</span> size<span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>renderer <span class="token operator">=</span> renderer<span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> size<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> size<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>ctx <span class="token operator">=</span> self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>renderTexture <span class="token operator">=</span> <span class="token constant">PIXI</span><span class="token punctuation">.</span>RenderTexture<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">,</span> self<span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>maskSprite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>renderTexture<span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span><span class="token function">rendMask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>darkTex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Texture<span class="token punctuation">.</span>fromImage</span><span class="token punctuation">(</span><span class="token string">&quot;assets/overlay2.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>darkSprite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>darkTex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>darkSprite<span class="token punctuation">.</span>filters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>SpriteMaskFilter</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>maskSprite<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>darkSprite<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> pt <span class="token operator">=</span> <span class="token class-name">Light</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

pt<span class="token punctuation">.</span><span class="token function-variable function">rendMask</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">center<span class="token punctuation">,</span> smallLights</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>center<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    center <span class="token operator">=</span> <span class="token punctuation">{</span>
      x<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span> <span class="token number">300</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    center<span class="token punctuation">.</span>x <span class="token operator">=</span> center<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    center<span class="token punctuation">.</span>y <span class="token operator">=</span> center<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  self<span class="token punctuation">.</span>ctx <span class="token operator">=</span> self<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  self<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> gradient <span class="token operator">=</span> self<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">createRadialGradient</span><span class="token punctuation">(</span>center<span class="token punctuation">.</span>x<span class="token punctuation">,</span> center<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> center<span class="token punctuation">.</span>x<span class="token punctuation">,</span> center<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> gradient<span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>self<span class="token punctuation">.</span>spr<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> texture <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Texture<span class="token punctuation">.</span>fromCanvas</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>spr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>texture<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    self<span class="token punctuation">.</span>spr<span class="token punctuation">.</span>texture<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  self<span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>spr<span class="token punctuation">,</span> self<span class="token punctuation">.</span>renderTexture<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//module.exports = Light;</span>
<span class="token keyword">var</span> light <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Light</span><span class="token punctuation">(</span><span class="token punctuation">{</span>width<span class="token operator">:</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">}</span><span class="token punctuation">,</span> renderer<span class="token punctuation">)</span><span class="token punctuation">;</span>

stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p>这样修改动画函数：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// just for fun, let's rotate mr rabbit a little</span>
    bunny<span class="token punctuation">.</span>rotation <span class="token operator">+=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>light<span class="token punctuation">)</span><span class="token punctuation">{</span>
      light<span class="token punctuation">.</span><span class="token function">rendMask</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token operator">:</span> renderer<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>interaction<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span>global<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y<span class="token operator">:</span> renderer<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>interaction<span class="token punctuation">.</span>mouse<span class="token punctuation">.</span>global<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// render the container</span>
    renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>stage<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>最终(简化版)产品是这样的:</p> <p>(移动鼠标查看效果)</p> <iframe width="800" height="600" src="/demo/tutorial-lights" frameborder="0" scrolling="no" style="overflow:hidden;"></iframe>
为了本教程的目的，我不得不精简代码，
在原始代码中，我实现了传递一系列小灯的功能，
这些灯用于环境照明和子弹发光。
在这种情况下，它有点复杂，并且占用大量CPU，
但是如果您使用较小的画布，并将其缩放到屏幕大小，则可以解决此问题。
在这种情况下，灯是有些像素化的感觉，
但是在游戏中使用时，可以有效避免为了实现单一效果牺牲太多资源。
<p>如果您有兴趣，请给我评论，我可能会写第二部分或扩大这篇文章的范围。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">lastUpdate:</span> <span class="time">4/19/2020, 4:44:05 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/proclive.io/pixi-js-drag-drop.html" class="prev">
        拖放教程
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a8316c89.js" defer></script><script src="/assets/js/2.e1e3a62a.js" defer></script><script src="/assets/js/15.df4177f0.js" defer></script>
  </body>
</html>
